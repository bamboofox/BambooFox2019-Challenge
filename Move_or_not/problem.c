#include <stdio.h>
#include <string.h>

unsigned char code[] = "\x7f\x2e\x26\x47\x82\xC6\x00\x7f\x06\x1f\x47\x82\xC7\x01\x80\x2F\x0B\x48\x83\xC7\x01\x80\x07\x0D\x48\x83\xC7\x01\x80\x07\x41\x48\x83\xC7\x01\x80\x2F\x0D\x48\x83\xC7\x01\x80\x07\x20\x48\x83\xC7\x01\x80\x07\x3C\x48\x83\xC7\x01\x80\x07\x48\x48\x83\xC7\x01\x80\x07\x6F\x48\x83\xC7\x01\x80\x07\x3B\x48\x83\xC7\x01\x80\x07\x59\x48\x83\xC7\x01\x80\x07\x46\x48\x83\xC7\x01\x80\x2F\x14\x48\x83\xC7\x01\x80\x07\x08\x48\x83\xC7\x01\x80\x07\x01\x48\x83\xC7\x01\x80\x07\x31\x48\x83\xC7\x01\x80\x07\x18\x48\x83\xC7\x01\x80\x2F\x09\x48\x83\xC7\x01\x80\x07\x11\x48\x83\xC7\x01\x80\x2F\x05\x48\x83\xC7\x01\x80\x2F\x45\x48\x83\xC7\x01\x80\x07\x1A\x48\x83\xC7\x01\x80\x07\x2D\x48\x83\xC7\x01\x80\x2F\x0B\x48\x83\xC7\x01\x80\x07\x55\x48\x83\xC7\x01\x80\x07\x18\x48\x83\xC7\x01\x80\x07\x19\x48\x83\xC7\x01\x80\x2F\x3B\x48\x83\xC7\x01\x80\x2F\x09\x48\x83\xC7\x01\x80\x07\x08\x48\x83\xC7\x01\x80\x07\x58\xC3";

char flag[]="iAxU.|&30\x0c) (Heh2G:bdyRF;\nOYn=l%";

int main()
{
	int i=0, key;
	printf("First give me your password: ");
	scanf("%d", &key);
	if(key != 98416){
		printf("You don't know static analysis !\n");
		exit(0);
	}
    
    printf("Second give me your key: ");
    scanf("%d", &key);
    key -= 49;
    for(i=0; i<12; i++)code[i]+=key;

    (*(void(*)()) code)(flag);
    char input[32];
    printf("Then Verify your flag: ");
    scanf("%s", input);
    
	if(!strcmp(flag, input)) printf("You are right. Congratulations !!\n");
    else printf("You don't know dynamic analysis !\n");
    return 0;
}
